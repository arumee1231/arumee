<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, user-scalable=yes" />
  <meta name="theme-color" content="#ffffff" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <title>Arumee â€” Premium Coldâ€‘Pressed Oils</title>
  <meta name="description" content="Arumee â€” Premium coldâ€‘pressed oils. Pure, natural, and traditionally pressed coconut, groundnut, and gingelly oils." />
  <link rel="icon" type="image/png" href="arumee_assets/favicon.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --green: #1e4d32;
      --green-dark: #153d28;
      --gold: #9d7c2a;
      --gold-light: #b8941f;
      --cream: #faf8f5;
      --ink: #0a2817;
      --accent: #8b4513;
      --shadow-sm: 0 2px 8px rgba(30, 77, 50, 0.08);
      --shadow-md: 0 4px 16px rgba(30, 77, 50, 0.12);
      --shadow-lg: 0 8px 32px rgba(30, 77, 50, 0.16);
      --shadow-xl: 0 16px 48px rgba(30, 77, 50, 0.2);
      --transition-smooth: cubic-bezier(0.4, 0, 0.2, 1);
    }
    * { box-sizing: border-box; }
    html {
      overflow-x: hidden;
      width: 100%;
    }
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      color: var(--ink);
      background: var(--cream);
      scroll-behavior: smooth;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
      width: 100%;
      position: relative;
    }
    .container { width: min(1200px, 92vw); margin: 0 auto; }

    /* STICKY NAVIGATION BAR */
    .sticky-nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(30, 77, 50, 0.1);
      z-index: 9997;
      transform: translateY(-100%);
      transition: transform 0.3s var(--transition-smooth);
      box-shadow: var(--shadow-md);
    }
    .sticky-nav.visible {
      transform: translateY(0);
    }
    .sticky-nav .nav-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      max-width: 1200px;
      margin: 0 auto;
      padding-left: 4vw;
      padding-right: 4vw;
    }
    .sticky-nav .nav-brand {
      display: flex;
      align-items: center;
      gap: 12px;
      font-family: 'Playfair Display', serif;
      font-size: 24px;
      font-weight: 800;
      color: var(--green);
    }
    .sticky-nav .nav-brand img {
      width: 40px;
      height: 40px;
      border-radius: 8px;
    }
    .sticky-nav .nav-actions {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .sticky-nav .nav-btn {
      padding: 8px 20px;
      border-radius: 999px;
      border: 2px solid var(--green);
      background: white;
      color: var(--green);
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }
    .sticky-nav .nav-btn.primary {
      background: var(--green);
      color: white;
    }
    .sticky-nav .nav-btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    /* TRUST BADGES */
    .trust-badges {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 24px;
      margin-top: 24px;
      flex-wrap: wrap;
    }
    .trust-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      border: 1px solid rgba(30, 77, 50, 0.15);
      font-size: 13px;
      font-weight: 600;
      color: var(--green);
      transition: all 0.3s ease;
    }
    .trust-badge:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
      border-color: var(--gold);
    }
    .trust-badge-icon {
      font-size: 20px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 28px;
      height: 28px;
    }
    
    /* Checkmark icon gets circular background */
    .trust-badge:first-child .trust-badge-icon {
      background: var(--green) !important;
      color: #ffffff !important;
      border-radius: 50% !important;
      font-weight: 900 !important;
      font-size: 16px !important;
      line-height: 1 !important;
      padding: 4px !important;
      display: inline-flex !important;
      align-items: center !important;
      justify-content: center !important;
      width: 24px !important;
      height: 24px !important;
    }

    /* BENEFIT CARDS */
    .benefit-card {
      background: linear-gradient(135deg, rgba(250, 248, 245, 0.5), rgba(255, 255, 255, 0.8));
      border: 1px solid rgba(30, 77, 50, 0.1);
    }
    .benefit-card:hover {
      background: white;
      transform: translateY(-4px);
      box-shadow: var(--shadow-md);
      border-color: var(--gold);
    }
    /* Force white tick only for the FSSAI Certified (3rd) benefit icon */
    #benefits .benefit-card:nth-child(3) > div:first-child {
      color: #ffffff !important;
      text-shadow: 0 1px 2px rgba(0,0,0,0.25);
    }

    /* HERO */
    header.hero {
      position: relative;
      padding: 50px 0 60px;
      background: linear-gradient(135deg, rgba(30,77,50,.08), rgba(157,124,42,.06));
      overflow: hidden;
      border-bottom: 3px solid var(--gold);
    }
    header.hero::before {
      content: '';
      position: absolute;
      inset: 0;
      background: url('arumee_assets/bg_texture.jpg') center/cover no-repeat;
      opacity: 0.03;
      z-index: 0;
    }
    .brand { display: flex; align-items: center; gap: 40px; position: relative; z-index: 1; }
    .brand img { 
      width: 160px; 
      height: 160px; 
      border-radius: 24px; 
      border: 3px solid var(--gold);
      box-shadow: var(--shadow-lg);
      transition: transform 0.3s ease;
    }
    .brand img:hover {
      transform: scale(1.05) rotate(2deg);
    }
    .name { 
      font-family: 'Playfair Display', serif; 
      font-size: 64px; 
      font-weight: 800; 
      color: var(--green);
      line-height: 1.1;
      letter-spacing: -1px;
    }
    .tagline { 
      font-size: 20px; 
      color: #1b3b25; 
      font-weight: 600;
      margin-top: 8px;
      letter-spacing: 0.5px;
    }
    .hero-cta { margin-top: 30px; display: flex; gap: 18px; flex-wrap: wrap; }
    .btn {
      padding: 16px 32px;
      border-radius: 999px;
      border: 3px solid var(--green);
      background: #fff;
      color: var(--green);
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s var(--transition-smooth);
      text-decoration: none;
      position: relative;
      overflow: hidden;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      transform: translate(-50%, -50%);
      transition: width 0.6s ease, height 0.6s ease;
    }
    .btn:hover::before {
      width: 300px;
      height: 300px;
    }
    .btn.fill {
      background: linear-gradient(135deg, var(--green), var(--green-dark));
      color: white;
      border-color: var(--green);
      box-shadow: var(--shadow-md);
    }
    .btn:hover { 
      transform: translateY(-3px); 
      border-color: var(--gold); 
      box-shadow: var(--shadow-xl);
    }
    .btn:active {
      transform: translateY(-1px);
    }

    /* CART TAB & DROPDOWN */
    .cart-tab {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--green);
      color: white;
      padding: 12px 16px;
      border-radius: 50px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 700;
      font-size: 16px;
      transition: all 0.3s ease;
      z-index: 9998;
      box-shadow: 0 4px 12px rgba(30, 77, 50, 0.3);
      height: auto;
      max-height: 60px;
      line-height: 1;
      flex: none;
    }
    
    /* Move cart down when sticky nav is visible */
    .sticky-nav.visible ~ main .cart-tab,
    .sticky-nav.visible ~ .cart-tab {
      top: 80px;
    }
    
    body:has(.sticky-nav.visible) .cart-tab {
      top: 80px;
    }
    
    .cart-tab:hover {
      background: var(--green-dark);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(30, 77, 50, 0.4);
    }
    
    .cart-icon { font-size: 18px; }
    
    .cart-count {
      background: var(--gold);
      color: white;
      border-radius: 50%;
      min-width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 800;
      animation: bounce 0.5s ease;
    }
    
    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-8px); }
      60% { transform: translateY(-4px); }
    }
    
    .cart-dropdown {
      position: fixed;
      top: 80px;
      right: 20px;
      background: white;
      border: 3px solid var(--green);
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
      width: 350px;
      max-height: 500px;
      z-index: 9999;
      overflow: hidden;
      /* Animation defaults */
      transform: translateX(110%);
      opacity: 0;
      pointer-events: none;
      transition: transform .35s cubic-bezier(.22,.9,.24,1), opacity .35s ease, top 0.3s ease;
      will-change: transform, opacity;
    }
    
    /* Move cart dropdown down when sticky nav is visible */
    body:has(.sticky-nav.visible) .cart-dropdown {
      top: 140px;
    }
    .cart-dropdown.open {
      transform: translateX(0);
      opacity: 1;
      pointer-events: auto;
    }
    .cart-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.25);
      backdrop-filter: blur(2px);
      z-index: 9998;
      opacity: 0;
      pointer-events: none;
      transition: opacity .3s ease;
    }
    .cart-backdrop.visible {
      opacity: 1;
      pointer-events: auto;
    }
    
    .cart-header {
      background: var(--green);
      color: white;
      padding: 16px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .cart-header h3 {
      margin: 0;
      font-size: 18px;
      font-weight: 700;
    }
    
    .cart-close {
      background: none;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background 0.3s ease;
    }
    
    .cart-close:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .cart-content {
      padding: 16px 20px;
      max-height: 300px;
      overflow-y: auto;
    }
    
    .empty-cart {
      text-align: center;
      color: #666;
      font-style: italic;
      margin: 20px 0;
    }
    
    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid #eee;
      gap: 12px;
    }
    
    .cart-item:last-child {
      border-bottom: none;
    }
    
    .cart-item-info {
      flex: 1;
      min-width: 0;
    }
    
    .cart-item-name {
      font-weight: 600;
      color: var(--green);
      font-size: 13px;
      line-height: 1.3;
      margin-bottom: 2px;
    }
    
    .cart-item-details {
      font-size: 11px;
      color: #666;
    }
    
    .cart-item-controls {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .cart-stepper {
      display: flex;
      align-items: center;
      gap: 6px;
      background: #f8f9fa;
      border-radius: 8px;
      padding: 4px;
    }
    
    .cart-stepper button {
      width: 24px;
      height: 24px;
      border: 1px solid var(--green);
      background: white;
      color: var(--green);
      font-size: 14px;
      font-weight: 700;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .cart-stepper button:hover {
      background: var(--green);
      color: white;
    }
    
    .cart-stepper input {
      width: 30px;
      height: 24px;
      text-align: center;
      font-size: 12px;
      font-weight: 600;
      border: 1px solid #ddd;
      border-radius: 4px;
      background: white;
      color: var(--green);
    }
    
    .cart-stepper input:focus {
      outline: none;
      border-color: var(--gold);
    }
    
    .cart-item-price {
      font-weight: 700;
      color: var(--green);
      font-size: 13px;
      min-width: 50px;
      text-align: right;
    }
    
    .cart-delete-btn {
      width: 24px;
      height: 24px;
      background: transparent;
      color: #666;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .cart-delete-btn:hover {
      background: #f5f5f5;
      color: #dc3545;
      transform: scale(1.1);
    }
    
    .cart-footer {
      background: #f8f9fa;
      padding: 16px 20px;
      border-top: 1px solid #eee;
    }
    
    .cart-total {
      font-size: 18px;
      font-weight: 700;
      color: var(--green);
      margin-bottom: 12px;
      text-align: center;
    }
    
    .cart-footer .btn {
      width: 100%;
      padding: 12px;
      font-size: 14px;
    }

    /* SECTIONS */
    section { 
      padding: 60px 0; 
      opacity: 0; 
      transform: translateY(30px); 
      transition: all 0.8s var(--transition-smooth);
    }
    section.visible { 
      opacity: 1; 
      transform: translateY(0); 
    }
    
    /* First section (oils) should have less top padding */
    section#oils {
      padding-top: 40px;
    }

    h2.section-title {
      font-family: 'Playfair Display', serif;
      font-size: 48px;
      color: var(--green);
      text-align: center;
      margin-bottom: 12px;
      margin-top: 0;
      font-weight: 800;
      letter-spacing: -1px;
      position: relative;
      display: inline-block;
      width: 100%;
    }
    h2.section-title::after {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 4px;
      background: linear-gradient(90deg, var(--gold), var(--gold-light));
      border-radius: 2px;
    }
    p.lead { 
      text-align: center; 
      font-size: 19px; 
      color: #1a4a2f; 
      margin-bottom: 48px; 
      margin-top: 20px;
      font-weight: 500;
      letter-spacing: 0.3px;
    }

    /* PRODUCTS */
    .grid { display: grid; gap: 24px; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }
    .card {
      background: white;
      border-radius: 24px;
      border: 2px solid transparent;
      overflow: hidden;
      position: relative;
      transition: all 0.4s var(--transition-smooth);
      box-shadow: var(--shadow-sm);
    }
    .card::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 24px;
      padding: 2px;
      background: linear-gradient(135deg, var(--gold), var(--green));
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask-composite: exclude;
      opacity: 0;
      transition: opacity 0.4s ease;
    }
    .card:hover::before {
      opacity: 1;
    }
    .card:hover { 
      transform: translateY(-8px) scale(1.02); 
      box-shadow: var(--shadow-xl);
    }
    
    /* Product Badge */
    .product-badge {
      position: absolute;
      top: 16px;
      right: 16px;
      background: linear-gradient(135deg, var(--gold), var(--gold-light));
      color: white;
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 11px;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      z-index: 2;
      box-shadow: var(--shadow-md);
    }
    
    .pic-wrap { 
      position: relative; 
      background: linear-gradient(135deg, #ffffff, #fafafa);
      padding: 20px; 
      text-align: center; 
      min-height: 220px; 
      display: flex; 
      align-items: center; 
      justify-content: center;
      cursor: zoom-in;
      overflow: hidden;
    }
    .pic-wrap::after {
      content: 'ðŸ”';
      position: absolute;
      bottom: 12px;
      right: 12px;
      background: rgba(255, 255, 255, 0.9);
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transform: scale(0.8);
      transition: all 0.3s ease;
      font-size: 14px;
      box-shadow: var(--shadow-sm);
    }
    .pic-wrap:hover::after {
      opacity: 1;
      transform: scale(1);
    }
    .pic-wrap img { 
      position: relative; 
      width: auto; 
      height: 180px; 
      max-width: 100%; 
      object-fit: contain;
      transition: transform 0.4s var(--transition-smooth);
      filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.08));
    }
    .pic-wrap:hover img {
      transform: scale(1.08);
    }
    .content { padding: 20px; }
    .pill { 
      display: inline-block; 
      font-weight: 800; 
      color: #fff; 
      background: linear-gradient(135deg, var(--green), #0d8f45); 
      border-radius: 999px; 
      padding: 6px 14px; 
      font-size: 12px;
      box-shadow: var(--shadow-sm);
      letter-spacing: 0.3px;
    }
    .title { 
      font-family: 'Inter', sans-serif; 
      font-size: 19px; 
      margin: 12px 0 8px; 
      font-weight: 700; 
      line-height: 1.3; 
      min-height: 50px; 
      display: flex; 
      align-items: center;
      color: var(--ink);
    }
    .price { 
      font-size: 28px; 
      font-weight: 800; 
      color: var(--green); 
      margin: 0 0 8px; 
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, var(--green), var(--green-dark));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .price span { 
      font-size: 14px; 
      color: #666; 
      font-weight: 500;
      -webkit-text-fill-color: #666;
    }
    .size-selector { margin: 12px 0; }
    .size-selector label { 
      display: block; 
      font-weight: 700; 
      color: var(--green); 
      margin-bottom: 8px; 
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .size-options { display: flex; gap: 8px; margin-bottom: 10px; }
    .size-option { 
      flex: 1; 
      padding: 10px 12px; 
      border: 2px solid #e0e0e0; 
      background: white; 
      color: var(--ink); 
      font-size: 13px; 
      font-weight: 700; 
      border-radius: 10px; 
      cursor: pointer; 
      transition: all 0.3s var(--transition-smooth); 
      text-align: center;
      position: relative;
    }
    .size-option.active { 
      background: linear-gradient(135deg, var(--green), var(--green-dark));
      color: white; 
      border-color: var(--green);
      box-shadow: var(--shadow-sm);
    }
    .size-option:hover:not(.active) { 
      background: linear-gradient(135deg, rgba(157, 124, 42, 0.1), rgba(157, 124, 42, 0.05));
      border-color: var(--gold); 
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
    }
    .quantity-selector { margin: 12px 0; }
    .quantity-selector label { 
      display: block; 
      font-weight: 700; 
      color: var(--green); 
      margin-bottom: 8px; 
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .quantity-stepper { 
      display: flex; 
      align-items: center; 
      gap: 10px;
      background: #f8f9fa;
      padding: 6px;
      border-radius: 12px;
      border: 2px solid #e0e0e0;
      transition: border-color 0.3s ease;
    }
    .quantity-stepper:hover {
      border-color: var(--gold);
    }
    .quantity-stepper button { 
      width: 36px; 
      height: 36px; 
      border: none; 
      background: white; 
      color: var(--green); 
      font-size: 20px; 
      font-weight: 700; 
      border-radius: 10px; 
      cursor: pointer; 
      transition: all 0.3s var(--transition-smooth); 
      display: flex; 
      align-items: center; 
      justify-content: center;
      box-shadow: var(--shadow-sm);
    }
    .quantity-stepper button:hover { 
      background: var(--green); 
      color: white;
      transform: scale(1.1);
    }
    .quantity-stepper button:active { transform: scale(0.95); }
    .quantity-stepper input { 
      flex: 1;
      min-width: 50px;
      height: 36px; 
      text-align: center; 
      font-size: 16px; 
      font-weight: 700; 
      border: none; 
      border-radius: 10px; 
      color: var(--green);
      background: white;
    }
    .quantity-stepper input:focus { 
      outline: none; 
      box-shadow: 0 0 0 2px var(--gold);
    }
    .add-to-order { 
      width: 100%; 
      margin-top: 14px; 
      padding: 14px; 
      background: linear-gradient(135deg, var(--green), #0d8f45); 
      color: white; 
      border: none; 
      border-radius: 12px; 
      font-weight: 700; 
      font-size: 15px; 
      cursor: pointer; 
      transition: all 0.3s var(--transition-smooth);
      position: relative;
      overflow: hidden;
      box-shadow: var(--shadow-md);
    }
    .add-to-order::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: width 0.6s ease, height 0.6s ease;
    }
    .add-to-order:hover::before {
      width: 300px;
      height: 300px;
    }
    .add-to-order:hover { 
      background: linear-gradient(135deg, #0d8f45, var(--green)); 
      transform: translateY(-2px); 
      box-shadow: var(--shadow-lg);
    }
    .add-to-order:active { transform: translateY(0); }


    /* ORDER FORM */
    form.card { 
      padding: 48px; 
      max-width: 900px; 
      margin: 0 auto;
      box-shadow: var(--shadow-lg);
      border: none;
    }
    form.card::before {
      opacity: 0.5;
    }
    form input, form select, form textarea {
      width: 100%; 
      padding: 16px 20px; 
      border-radius: 12px; 
      border: 2px solid #e0e0e0;
      font-size: 16px; 
      margin-top: 8px; 
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
    }
    
    /* Form validation styles */
    form input:invalid:not(:focus):not(:placeholder-shown) {
      border-color: #dc3545;
      background-color: #fff5f5;
    }
    
    form input:valid:not(:focus):not(:placeholder-shown) {
      border-color: #28a745;
      background-color: #f0fff4;
    }
    
    form input:focus, form select:focus, form textarea:focus {
      outline: none;
      border-color: var(--gold);
      box-shadow: 0 0 0 3px rgba(157, 124, 42, 0.1);
      background: white;
    }
    
    form label {
      font-weight: 600;
      color: var(--green);
      font-size: 14px;
      letter-spacing: 0.3px;
    }

    /* FOOTER */
    footer {
      background: linear-gradient(135deg, rgba(30,77,50,.08), rgba(157,124,42,.05));
      border-top: 1px solid rgba(30, 77, 50, 0.15);
      text-align: center;
      padding: 60px 0 40px;
      color: var(--green-dark);
      position: relative;
    }
    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 3px;
      background: linear-gradient(90deg, transparent, var(--gold), transparent);
    }
    footer .tag { 
      font-family: 'Playfair Display', serif; 
      font-style: italic; 
      font-size: 20px; 
      margin-bottom: 16px;
      color: var(--green);
      font-weight: 600;
    }
    footer .mini { 
      font-size: 15px;
      color: #666;
      margin-top: 8px;
    }
    footer a {
      color: var(--green);
      text-decoration: none;
      font-weight: 600;
      transition: color 0.3s ease;
    }
    footer a:hover {
      color: var(--gold);
    }

    /* TOAST NOTIFICATION */
    .toast { 
      position: fixed; 
      top: -100px; 
      left: 50%; 
      transform: translateX(-50%); 
      background: linear-gradient(135deg, rgba(30, 77, 50, 0.95), rgba(21, 61, 40, 0.95));
      color: white; 
      padding: 16px 32px; 
      border-radius: 16px; 
      font-weight: 600; 
      font-size: 15px; 
      z-index: 10001; 
      transition: all 0.4s var(--transition-smooth);
      box-shadow: var(--shadow-xl);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      opacity: 0;
      visibility: hidden;
      border: 1px solid rgba(255, 255, 255, 0.1);
      max-width: 90vw;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .toast::before {
      content: 'âœ“';
      font-size: 20px;
      font-weight: 800;
      color: white;
      flex-shrink: 0;
    }
    .toast.show { 
      top: 24px;
      opacity: 1;
      visibility: visible;
    }

    /* SCROLL-TOP BUTTON */
    #scrollTop {
      position: fixed; 
      bottom: 30px; 
      right: 30px;
      width: 52px; 
      height: 52px;
      border-radius: 50%; 
      border: none;
      background: linear-gradient(135deg, var(--green), var(--green-dark));
      color: white;
      cursor: pointer; 
      font-size: 22px; 
      display: none;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-lg);
      transition: all 0.3s var(--transition-smooth);
      z-index: 999;
    }
    #scrollTop:hover { 
      background: linear-gradient(135deg, var(--gold), var(--gold-light));
      transform: translateY(-4px);
      box-shadow: var(--shadow-xl);
    }
    #scrollTop:active {
      transform: translateY(-2px);
    }

    /* WHATSAPP BUTTON */
    #whatsappBtn { 
      position: fixed; 
      bottom: 20px; 
      left: 20px; 
      background: transparent; 
      border-radius: 50%; 
      width: 60px; 
      height: 60px; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      box-shadow: 0 4px 12px rgba(0,0,0,.15); 
      z-index: 999; 
      transition: all .3s ease; 
      text-decoration: none; 
    }
    #whatsappBtn img {
      width: 100%;
      height: 100%;
      border-radius: 50%;
    }
    #whatsappBtn:hover { 
      transform: scale(1.1); 
      box-shadow: 0 6px 20px rgba(0,0,0,.25); 
    }

    /* CUSTOM MODAL */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(4px);
      z-index: 9999;
      animation: fadeIn 0.3s ease;
    }
    .modal-overlay.show {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .modal-content {
      background: white;
      border-radius: 12px;
      padding: 20px;
      max-width: 320px;
      width: 90%;
      animation: slideIn 0.3s ease;
      position: relative;
      border: 2px solid var(--green);
    }
    .modal-icon {
      width: 48px;
      height: 48px;
      background: linear-gradient(135deg, var(--green), var(--green-dark));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      margin: 0 auto 12px;
      color: white;
      font-weight: 900;
    }
    .modal-title {
      font-family: 'Playfair Display', serif;
      font-size: 18px;
      font-weight: 700;
      color: var(--green);
      text-align: center;
      margin: 0 0 10px;
    }
    .modal-message {
      font-size: 14px;
      line-height: 1.4;
      color: #333;
      text-align: center;
      margin-bottom: 16px;
    }
    .modal-message ul {
      list-style: none;
      padding: 0;
      margin: 12px 0;
      text-align: left;
    }
    .modal-message li {
      padding: 6px 0;
      padding-left: 24px;
      position: relative;
    }
    .modal-message li:before {
      content: 'â€¢';
      position: absolute;
      left: 8px;
      color: var(--gold);
      font-weight: bold;
    }
    .modal-buttons {
      display: flex;
      gap: 8px;
      justify-content: center;
    }
    .modal-btn {
      padding: 10px 20px;
      border-radius: 8px;
      border: none;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'Inter', sans-serif;
    }
    .modal-btn.primary {
      background: linear-gradient(135deg, var(--green), var(--green-dark));
      color: white;
    }
    .modal-btn.primary:hover {
      transform: translateY(-2px);
    }
    .modal-btn.secondary {
      background: #f0f0f0;
      color: #555;
    }
    .modal-btn.secondary:hover {
      background: #e0e0e0;
    }
    .modal-btn.danger {
      background: linear-gradient(135deg, #dc3545, #c82333);
      color: white;
    }
    .modal-btn.danger:hover {
      background: linear-gradient(135deg, #c82333, #a71e2a);
      transform: translateY(-2px);
    }
    .modal-btn.soft-primary {
      background: linear-gradient(135deg, #6c757d, #5a6268);
      color: white;
    }
    .modal-btn.soft-primary:hover {
      background: linear-gradient(135deg, #5a6268, #495057);
      transform: translateY(-2px);
    }
    .modal-icon.warning {
      background: linear-gradient(135deg, #ff9800, #f57c00);
    }
    .modal-icon.info {
      background: linear-gradient(135deg, #17a2b8, #138496);
    }

    /* IMAGE ZOOM OVERLAY */
    .zoom-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(8px);
      z-index: 10000;
      animation: fadeIn 0.3s ease;
      cursor: pointer;
    }
    .zoom-overlay.show {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .zoom-container {
      position: relative;
      max-width: 90vw;
      max-height: 90vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .zoom-close {
      position: absolute;
      top: -60px;
      right: 0;
      background: none;
      border: none;
      color: white;
      font-size: 40px;
      cursor: pointer;
      z-index: 10001;
      transition: all 0.2s ease;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }
    .zoom-close:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: scale(1.1);
    }
    #zoomedImage {
      max-width: 100%;
      max-height: 80vh;
      object-fit: contain;
      border-radius: 12px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      animation: slideIn 0.3s ease;
    }
    .zoom-caption {
      color: white;
      font-size: 18px;
      font-weight: 600;
      margin-top: 20px;
      text-align: center;
      font-family: 'Playfair Display', serif;
    }
    .pic-wrap {
      cursor: zoom-in;
      transition: transform 0.2s ease;
    }
    .pic-wrap:hover {
      transform: scale(1.05);
    }
    
    /* Loading state for buttons */
    .btn.loading, .add-to-order.loading {
      position: relative;
      pointer-events: none;
      opacity: 0.7;
    }
    .btn.loading::after, .add-to-order.loading::after {
      content: '';
      position: absolute;
      width: 16px;
      height: 16px;
      top: 50%;
      left: 50%;
      margin-left: -8px;
      margin-top: -8px;
      border: 2px solid transparent;
      border-top-color: white;
      border-radius: 50%;
      animation: spin 0.6s linear infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes slideIn {
      from { 
        transform: translateY(-30px);
        opacity: 0;
      }
      to { 
        transform: translateY(0);
        opacity: 1;
      }
    }

    /* MOBILE RESPONSIVE */
    @media (max-width: 768px) {
      body {
        overflow-x: hidden;
      }
      
      .container { 
        width: 100%; 
        max-width: 100%;
        padding-left: 16px;
        padding-right: 16px;
        margin: 0 auto;
      }
      
      /* Sticky Navigation Mobile */
      .sticky-nav .nav-content {
        padding-left: 16px;
        padding-right: 16px;
        max-width: 100%;
      }
      .sticky-nav .nav-brand {
        font-size: 18px;
      }
      .sticky-nav .nav-brand img {
        width: 32px;
        height: 32px;
      }
      .sticky-nav .nav-btn {
        padding: 6px 14px;
        font-size: 12px;
      }
      
      /* Trust badges mobile */
      .trust-badges {
        gap: 12px;
        margin-top: 16px;
      }
      .trust-badge {
        padding: 8px 12px;
        font-size: 11px;
      }
      .trust-badge-icon {
        font-size: 16px;
      }
      
      .trust-badge:first-child .trust-badge-icon {
        font-size: 14px;
      }
      
      /* Cart responsive */
      .cart-tab {
        top: auto !important;
        right: 16px;
        bottom: 16px;
        padding: 0;
        width: 56px;
        height: 56px;
        border-radius: 50%;
        font-size: 12px;
        justify-content: center;
        box-shadow: 0 6px 16px rgba(30,77,50,.35);
        background: linear-gradient(135deg, var(--green), var(--green-dark));
      }
      
      .cart-dropdown {
        top: auto !important;
        bottom: 80px;
        right: 12px;
        width: calc(100vw - 24px);
        max-width: 360px;
      }

      .cart-tab .cart-icon { font-size: 22px; }
      .cart-tab .cart-count {
        position: absolute;
        top: 4px;
        right: 6px;
        min-width: 20px;
        height: 20px;
        font-size: 11px;
        box-shadow: 0 2px 6px rgba(0,0,0,.25);
        animation: none;
      }
      body:has(.sticky-nav.visible) .cart-dropdown { bottom: 100px; top: auto; }
      body:has(.sticky-nav.visible) .cart-tab { bottom: 20px; top: auto; }
      
      /* Cart item controls mobile */
      .cart-item {
        padding: 10px 0;
        gap: 8px;
      }
      
      .cart-item-name {
        font-size: 12px;
      }
      
      .cart-stepper button {
        width: 22px;
        height: 22px;
        font-size: 12px;
      }
      
      .cart-stepper input {
        width: 28px;
        height: 22px;
        font-size: 11px;
      }
      
      .cart-delete-btn {
        width: 22px;
        height: 22px;
        font-size: 12px;
      }
      
      /* Hero section - Reduced height for mobile to show products */
      header.hero { padding: 30px 0 40px; }
      .brand { flex-direction: column; gap: 20px; text-align: center; }
      .brand img { 
        width: 100px; 
        height: 100px;
        margin: 0 auto;
      }
      .name { 
        font-size: 36px; 
        line-height: 1.1; 
        margin: 0;
      }
      .tagline { 
        font-size: 15px; 
        margin: 8px 0 0;
      }
      .hero-cta { 
        justify-content: center; 
        gap: 12px; 
        margin-top: 20px;
      }
      .btn { 
        padding: 12px 24px; 
        font-size: 14px;
        width: 100%;
        max-width: 280px;
      }
      
      /* Sections - Better spacing for mobile */
      section { padding: 40px 0; }
      section#oils {
        padding-top: 30px;
      }
      h2.section-title { 
        font-size: 32px; 
        margin-top: 0; 
        margin-bottom: 10px;
      }
      h2.section-title::after {
        width: 60px;
        height: 3px;
        bottom: -6px;
      }
      p.lead { 
        font-size: 16px; 
        margin-bottom: 32px;
      }
      
      /* Benefits section mobile */
      #benefits {
        padding: 40px 0 !important;
        overflow-x: hidden;
      }
      #benefits .container {
        padding-left: 16px;
        padding-right: 16px;
      }
      #benefits > div > div {
        gap: 20px !important;
      }
      #benefits .benefit-card {
        padding: 20px !important;
      }
      #benefits .benefit-card h3 {
        font-size: 18px !important;
      }
      #benefits .benefit-card p {
        font-size: 14px !important;
      }
      #benefits .benefit-card > div:first-child {
        width: 52px !important;
        height: 52px !important;
        font-size: 26px !important;
        margin-bottom: 12px !important;
      }
      
      /* Product grid -> mobile carousel (horizontal scroll snap) */
      .grid {
        display: flex;
        gap: 16px;
        overflow-x: auto;
        overflow-y: visible;
        -webkit-overflow-scrolling: touch;
        scroll-snap-type: x mandatory;
        padding: 20px 16px 32px 16px;
        align-items: center;
        margin-left: -16px;
        margin-right: -16px;
        width: calc(100% + 32px);
        max-width: 100vw;
      }

      /* Hide native scrollbar for a cleaner carousel look */
      .grid::-webkit-scrollbar { display: none; }
      .grid { -ms-overflow-style: none; scrollbar-width: none; }

      /* Each card becomes a horizontally scrollable 'slide' */
      .grid .card {
        flex: 0 0 calc(100% - 80px);
        max-width: 340px;
        min-width: 260px;
        scroll-snap-align: center;
        border-radius: 20px;
      }

      /* Disable hover transform on mobile to avoid layout shifts while scrolling */
      .grid .card:hover { transform: none; }

      /* Active slide styling */
      .grid .card {
        transition: transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .28s cubic-bezier(.2,.9,.2,1);
        will-change: transform;
      }

      .grid .card.active-slide {
        transform: translateY(-6px);
        border-color: var(--green);
        box-shadow: 0 20px 48px rgba(30,77,50,0.18);
        z-index: 4;
      }

      /* Scale the product image inside the active card */
      .pic-wrap img {
        transition: transform .36s cubic-bezier(.2,.9,.2,1);
        will-change: transform;
        transform-origin: 50% 50%;
      }

      .grid .card.active-slide .pic-wrap img {
        transform: scale(1.08);
      }
      
      /* Product image area */
      .pic-wrap {
        height: 220px;
        padding: 16px;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #ffffff;
      }
      .pic-wrap img {
        display: block;
        width: auto;
        height: 90%;
        max-width: 120%;
        object-fit: contain;
        object-position: 50% 50%;
        transform-origin: 50% 50%;
      }
      
      /* Product content */
      .content { padding: 20px; }
      .pill {
        font-size: 12px;
        padding: 6px 14px;
      }
      .title { 
        font-size: 20px; 
        min-height: 52px;
        margin: 12px 0 10px;
      }
      .price { 
        font-size: 26px;
        margin-bottom: 10px;
      }
      .price span {
        font-size: 14px;
      }
      
      /* Size selector mobile */
      .size-selector {
        margin: 14px 0;
      }
      .size-selector label {
        font-size: 11px;
        margin-bottom: 8px;
      }
      .size-options {
        gap: 6px;
      }
      .size-option {
        padding: 8px 10px;
        font-size: 12px;
        border-radius: 8px;
      }
      
      /* Quantity selector mobile */
      .quantity-selector {
        margin: 14px 0;
      }
      .quantity-selector label {
        font-size: 11px;
        margin-bottom: 8px;
      }
      .quantity-stepper {
        padding: 5px;
        gap: 8px;
      }
      .quantity-stepper button {
        width: 32px;
        height: 32px;
        font-size: 18px;
      }
      .quantity-stepper input {
        height: 32px;
        font-size: 15px;
      }
      
      /* Add to order button */
      .add-to-order {
        margin-top: 14px;
        padding: 12px;
        font-size: 14px;
        border-radius: 10px;
      }
      
      /* Form */
      form.card { padding: 28px 20px; }
      form input, form select, form textarea { 
        padding: 14px 16px; 
        font-size: 15px; 
        border-radius: 10px; 
        border-width: 2px;
      }
      form label {
        font-size: 13px;
      }
      .form-row { 
        flex-direction: column; 
        gap: 0; 
        grid-template-columns: 1fr !important;
      }
      .form-buttons { 
        flex-direction: column; 
        gap: 12px;
        margin-top: 24px;
      }
      .form-buttons .btn { 
        width: 100%;
        max-width: none;
      }
      
      /* Manual selection mobile */
      #manualSelection div[style*="grid-template-columns"] {
        grid-template-columns: 1fr !important;
        gap: 12px !important;
      }
      #manualSelection .manual-oil-select,
      #manualSelection .manual-qty {
        font-size: 15px !important;
        padding: 12px !important;
      }
      #manualSelection button[onclick*="removeManualOil"] {
        padding: 10px 16px !important;
        font-size: 14px !important;
        width: 100%;
        margin-top: 8px;
      }
      #manualSelection button[onclick="addManualOil()"] {
        font-size: 14px !important;
        padding: 10px 20px !important;
      }
      
      /* Toast & Scroll button */
      .toast { 
        padding: 14px 24px; 
        font-size: 14px; 
        border-radius: 12px;
        top: 10px;
        max-width: calc(100vw - 40px);
      }
      .toast.show { 
        top: 15px;
      }
      #scrollTop { 
        width: 48px; 
        height: 48px; 
        font-size: 20px; 
        bottom: 24px; 
        right: 20px;
      }
      #whatsappBtn { 
        width: 56px; 
        height: 56px; 
        bottom: 24px; 
        left: 20px;
      }
      
      /* Footer */
      footer { 
        padding: 40px 0 30px;
      }
      footer .tag { 
        font-size: 17px;
      }
      footer .mini { 
        font-size: 13px;
      }
    }

    @media (max-width: 480px) {
      .container { 
        padding-left: 12px;
        padding-right: 12px;
        max-width: 100%;
      }
      
      .sticky-nav .nav-content {
        padding-left: 12px;
        padding-right: 12px;
      }
      
      /* Even more compact cart for very small screens */
      .cart-tab {
        top: auto !important;
        bottom: 14px;
        right: 14px;
        padding: 0;
        width: 52px;
        height: 52px;
        border-radius: 50%;
        font-size: 11px;
      }
      
      .cart-dropdown {
        top: auto !important;
        bottom: 76px;
        right: 10px;
        width: calc(100vw - 20px);
      }
      
      /* Even smaller cart controls */
      .cart-item {
        flex-direction: column;
        align-items: stretch;
        gap: 8px;
        padding: 8px 0;
      }
      
      .cart-item-controls {
        justify-content: space-between;
      }
      
      .cart-stepper button {
        width: 20px;
        height: 20px;
        font-size: 11px;
      }
      
      .cart-stepper input {
        width: 26px;
        height: 20px;
        font-size: 10px;
      }
      
      .cart-delete-btn {
        width: 20px;
        height: 20px;
        font-size: 11px;
      }
      
      /* Compact hero for very small screens */
      header.hero { padding: 20px 0 30px; }
      .brand img { 
        width: 90px; 
        height: 90px;
      }
      .name { 
        font-size: 30px;
      }
      .tagline { 
        font-size: 14px;
      }
      h2.section-title { 
        font-size: 28px; 
        margin-bottom: 8px;
      }
      h2.section-title::after {
        width: 50px;
      }
      p.lead {
        font-size: 15px;
        margin-bottom: 28px;
      }
      .btn { 
        padding: 10px 20px; 
        font-size: 13px;
      }
      
      /* Compact product cards */
      .grid {
        padding: 20px 12px 32px 12px;
        margin-left: -12px;
        margin-right: -12px;
        width: calc(100% + 24px);
      }
      .grid .card {
        flex: 0 0 calc(100% - 60px);
        min-width: 240px;
        max-width: 300px;
      }
      
      #benefits .container {
        padding-left: 12px;
        padding-right: 12px;
      }
      .pic-wrap {
        height: 200px;
        padding: 14px;
      }
      .pic-wrap img { 
        height: 88%;
      }
      .content {
        padding: 16px;
      }
      .title { 
        font-size: 18px;
        min-height: 48px;
      }
      .price { 
        font-size: 24px;
      }
      .quantity-stepper button { 
        width: 30px; 
        height: 30px; 
        font-size: 16px;
      }
      .quantity-stepper input { 
        height: 30px; 
        font-size: 14px;
      }
      
      /* Compact benefits */
      #benefits .benefit-card > div:first-child {
        width: 48px !important;
        height: 48px !important;
        font-size: 24px !important;
      }
      #benefits .benefit-card h3 {
        font-size: 17px !important;
      }
      #benefits .benefit-card p {
        font-size: 13px !important;
      }
      
      /* Form mobile improvements */
      form.card { padding: 20px 16px; }
      form input, form select, form textarea { 
        padding: 12px 14px; 
        font-size: 14px; 
        border-radius: 8px; 
      }
      
      /* Manual selection improvements */
      #manualSelection div[style*="grid-template-columns"] {
        display: block !important;
        margin-bottom: 12px !important;
      }
      #manualSelection div[style*="grid-template-columns"] > div {
        margin-bottom: 10px;
      }
      #manualSelection .manual-oil-select,
      #manualSelection .manual-qty {
        font-size: 14px !important;
        padding: 10px !important;
        width: 100% !important;
      }
      #manualSelection button[onclick*="removeManualOil"] {
        padding: 8px !important;
        font-size: 13px !important;
        width: 100% !important;
      }
      #manualSelection button[onclick="addManualOil()"] {
        font-size: 13px !important;
        padding: 8px 16px !important;
      }
      
      /* Compact scroll buttons */
      #scrollTop {
        width: 44px;
        height: 44px;
        font-size: 18px;
        bottom: 20px;
        right: 16px;
      }
      #whatsappBtn {
        width: 50px;
        height: 50px;
        bottom: 20px;
        left: 16px;
      }
    }
  
/* --- Carousel inactive grayscale effect --- */


.grid .card.active-slide {
  filter: grayscale(0) brightness(1);
  transform: translateY(-6px);
  border-color: var(--green);
  box-shadow: 0 20px 48px rgba(30,77,50,0.18);
  z-index: 4;
}


/* --- Carousel inactive grayscale effect (mobile only) --- */
@media (max-width: 768px) {
  
  .grid .card.active-slide {
    filter: grayscale(0) brightness(1);
    transform: translateY(-6px);
    border-color: var(--green);
    box-shadow: 0 20px 48px rgba(30,77,50,0.18);
    z-index: 4;
  }
}


/* --- Carousel inactive grayscale effect (STRICTLY mobile only) --- */
@media screen and (max-width: 767px) {
  #oils .grid .card {
    filter: grayscale(0.8) brightness(0.85);
    transition:
      transform .28s cubic-bezier(.2,.9,.2,1),
      box-shadow .28s cubic-bezier(.2,.9,.2,1),
      filter .4s ease;
  }
  #oils .grid .card.active-slide {
    filter: grayscale(0) brightness(1);
    transform: translateY(-6px);
    border-color: var(--green);
    box-shadow: 0 20px 48px rgba(30,77,50,0.18);
    z-index: 4;
  }
}


/* --- Mobile FAB placement for Cart (prevents disappearing with collapsing top bars) --- */
@media (max-width: 768px) {
  .cart-tab {
    position: fixed;
    top: auto;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 10050;
    padding: 12px 24px;
    border-radius: 50px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.25);
    font-size: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    will-change: transform;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .cart-tab:active {
    transform: translateX(-50%) scale(0.95);
  }
  /* Adjust other floating buttons */
  #scrollTop {
    bottom: 90px;
    right: 20px;
  }
  #whatsappBtn {
    bottom: 90px;
    left: 20px;
  }
}

</style>
</head>
<body>
  <!-- Sticky Navigation -->
  <nav class="sticky-nav" id="stickyNav">
    <div class="nav-content">
      <div class="nav-brand">
        <img src="arumee_assets/logo.png" alt="Arumee" />
        <span>ARUMEE</span>
      </div>
      <div class="nav-actions">
        <a href="#oils" class="nav-btn">Our Oils</a>
        <a href="#order" class="nav-btn primary">Order Now</a>
      </div>
    </div>
  </nav>

  <header class="hero">
    <div class="container">      
      <div class="brand">
        <img src="arumee_assets/logo.png" alt="Arumee logo" />
        <div>
          <div class="name">ARUMEE<sup style="font-size:0.4em; color:var(--gold); font-weight:800;">â„¢</sup></div>
          <div class="tagline">Premium coldâ€‘pressed oils</div>
          <div class="trust-badges">
            <div class="trust-badge">
              <span class="trust-badge-icon">âœ“</span>
              <span>FSSAI Certified</span>
            </div>
            <div class="trust-badge">
              <span class="trust-badge-icon">ðŸŒ¿</span>
              <span>100% Natural</span>
            </div>
            <div class="trust-badge">
              <span class="trust-badge-icon">ðŸ†</span>
              <span>Premium Quality</span>
            </div>
            <div class="trust-badge">
              <span class="trust-badge-icon">ðŸšš</span>
              <span>Home Delivery</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Floating Cart Tab -->
  <div id="cartTab" class="cart-tab" onclick="toggleCart()" role="button" aria-label="Shopping cart" aria-expanded="false">
    <span class="cart-icon" aria-hidden="true">ðŸ›’</span>
    <span class="cart-count" id="cartCount" aria-live="polite">0</span>
  </div>

  <!-- Cart Dropdown -->
  <div id="cartDropdown" class="cart-dropdown" role="dialog" aria-labelledby="cartHeader">
    <div class="cart-header">
      <h3 id="cartHeader">Your Cart</h3>
      <button class="cart-close" onclick="toggleCart()" aria-label="Close cart">Ã—</button>
    </div>
    <div class="cart-content" id="cartContent">
      <p class="empty-cart">Your cart is empty</p>
    </div>
    <div class="cart-footer" id="cartFooter" style="display: none;">
      <div class="cart-total" id="cartTotal">Total: â‚¹0</div>
      <button class="btn fill" onclick="scrollToOrder()">Proceed to Order</button>
    </div>
  </div>
  <div id="cartBackdrop" class="cart-backdrop"></div>

  <main>
    <section id="oils">
      <div class="container">
        <h2 class="section-title">Our Signature Oils</h2>
        <p class="lead">Pure, natural, and traditionally pressed.</p>
        <div class="grid">
          <article class="card">
            <div class="pic-wrap"><img src="arumee_assets/mockup_coconut.png" alt="Coconut Oil" /></div>
            <div class="content">
              <span class="pill" id="coconut-pill">Coconut â€¢ 500ml</span>
              <div class="title">Coldâ€‘Pressed Coconut Oil</div>
              <div class="price" id="coconut-price">â‚¹225 <span>/ 500ml</span></div>
              
              <div class="size-selector">
                <label>SIZE</label>
                <div class="size-options">
                  <div class="size-option active" data-product="coconut" data-size="500ml" data-price="225">500ml</div>
                  <div class="size-option" data-product="coconut" data-size="1L" data-price="450">1L</div>
                  <div class="size-option" data-product="coconut" data-size="5L" data-price="2250">5L</div>
                </div>
              </div>

              <div class="quantity-selector">
                <label for="qty-coconut">Quantity</label>
                <div class="quantity-stepper">
                  <button type="button" onclick="decreaseQty('coconut')">âˆ’</button>
                  <input type="number" id="qty-coconut" value="1" min="1" max="10" oninput="validateQty('coconut')" />
                  <button type="button" onclick="increaseQty('coconut')">+</button>
                </div>
              </div>
              <button class="add-to-order" onclick="addToOrder('coconut', 'Cold-Pressed Coconut Oil', getCurrentPrice('coconut'))">Add to Order</button>
            </div>
          </article>
                    <article class="card">
            <div class="pic-wrap"><img src="arumee_assets/mockup_groundnut.png" alt="Groundnut Oil" /></div>
            <div class="content">
              <span class="pill" id="groundnut-pill">Groundnut â€¢ 500ml</span>
              <div class="title">Wooden Coldâ€‘Pressed Groundnut Oil</div>
              <div class="price" id="groundnut-price">â‚¹275 <span>/ 500ml</span></div>
              
              <div class="size-selector">
                <label>SIZE</label>
                <div class="size-options">
                  <div class="size-option active" data-product="groundnut" data-size="500ml" data-price="275">500ml</div>
                  <div class="size-option" data-product="groundnut" data-size="1L" data-price="550">1L</div>
                  <div class="size-option" data-product="groundnut" data-size="5L" data-price="2750">5L</div>
                </div>
              </div>

              <div class="quantity-selector">
                <label for="qty-groundnut">Quantity</label>
                <div class="quantity-stepper">
                  <button type="button" onclick="decreaseQty('groundnut')">âˆ’</button>
                  <input type="number" id="qty-groundnut" value="1" min="1" max="10" oninput="validateQty('groundnut')" />
                  <button type="button" onclick="increaseQty('groundnut')">+</button>
                </div>
              </div>
              <button class="add-to-order" onclick="addToOrder('groundnut', 'Wooden Cold-Pressed Groundnut Oil', getCurrentPrice('groundnut'))">Add to Order</button>
            </div>
          </article>
          <article class="card">
            <div class="pic-wrap"><img src="arumee_assets/mockup_gingelly.png" alt="Gingelly Oil" /></div>
            <div class="content">
              <span class="pill" id="gingelly-pill">Gingelly â€¢ 500ml</span>
              <div class="title">Wooden Coldâ€‘Pressed Gingelly Oil</div>
              <div class="price" id="gingelly-price">â‚¹275 <span>/ 500ml</span></div>
              
              <div class="size-selector">
                <label>SIZE</label>
                <div class="size-options">
                  <div class="size-option active" data-product="gingelly" data-size="500ml" data-price="275">500ml</div>
                  <div class="size-option" data-product="gingelly" data-size="1L" data-price="550">1L</div>
                  <div class="size-option" data-product="gingelly" data-size="5L" data-price="2750">5L</div>
                </div>
              </div>

              <div class="quantity-selector">
                <label for="qty-gingelly">Quantity</label>
                <div class="quantity-stepper">
                  <button type="button" onclick="decreaseQty('gingelly')">âˆ’</button>
                  <input type="number" id="qty-gingelly" value="1" min="1" max="10" oninput="validateQty('gingelly')" />
                  <button type="button" onclick="increaseQty('gingelly')">+</button>
                </div>
              </div>
              <button class="add-to-order" onclick="addToOrder('gingelly', 'Wooden Cold-Pressed Gingelly Oil', getCurrentPrice('gingelly'))">Add to Order</button>
            </div>
          </article>
        </div>
      </div>
    </section>

    <section id="benefits" style="background: white; padding: 60px 0; border-top: 1px solid rgba(30, 77, 50, 0.1);">
      <div class="container">
        <h2 class="section-title">Why Choose Arumee?</h2>
        <p class="lead">Crafted with tradition, delivered with care</p>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 32px; margin-top: 40px;">
          <div style="text-align: center; padding: 24px; border-radius: 16px; transition: all 0.3s ease;" class="benefit-card">
            <div style="width: 64px; height: 64px; margin: 0 auto 16px; background: linear-gradient(135deg, var(--green-dark), var(--green)); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: var(--shadow-md);">
              <!-- Natural.png icon asset -->
              <img src="arumee_assets/Natural.png" alt="100% Pure & Natural" loading="lazy" style="width:44px;height:44px;display:block;object-fit:contain;filter:drop-shadow(0 1px 2px rgba(0,0,0,.25));" />
            </div>
            <h3 style="font-family: 'Playfair Display', serif; font-size: 22px; color: var(--green); margin: 0 0 12px;">100% Pure & Natural</h3>
            <p style="color: #666; line-height: 1.6; margin: 0;">No chemicals, no preservatives. Just pure, cold-pressed goodness from farm to bottle.</p>
          </div>
          <div style="text-align: center; padding: 24px; border-radius: 16px; transition: all 0.3s ease;" class="benefit-card">
            <div style="width: 64px; height: 64px; margin: 0 auto 16px; background: linear-gradient(135deg, var(--gold), var(--gold-light)); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: var(--shadow-md);">
              <!-- Traditional method icon (droplet + snowflake) -->
              <svg role="img" aria-label="Traditional cold-pressed method" width="40" height="40" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" style="display:block;">
                <!-- Outer droplet -->
                <path d="M32 6C26 16 20 24 17 31c-2 4-3 8-3 12a18 18 0 0 0 36 0c0-4-1-8-3-12-3-7-9-15-15-25Z" stroke="#ffffff" stroke-width="2.6" fill="rgba(255,255,255,0.12)" stroke-linejoin="round" />
                <!-- Inner contour -->
                <path d="M32 15c-4.5 7-8.1 12.4-10.2 16.7-1.3 2.7-2 5.4-2 8.3a14.2 14.2 0 0 0 28.4 0c0-2.9-.7-5.6-2-8.3C40.1 27.4 36.5 22 32 15Z" stroke="#ffffff" stroke-width="2" stroke-linejoin="round" />
                <!-- Snowflake center -->
                <g stroke="#ffffff" stroke-width="2" stroke-linecap="round">
                  <line x1="32" y1="24" x2="32" y2="40" />
                  <line x1="24" y1="32" x2="40" y2="32" />
                  <line x1="26.5" y1="26.5" x2="37.5" y2="37.5" />
                  <line x1="37.5" y1="26.5" x2="26.5" y2="37.5" />
                  <!-- Tips -->
                  <line x1="32" y1="24" x2="29.5" y2="26" />
                  <line x1="32" y1="24" x2="34.5" y2="26" />
                  <line x1="32" y1="40" x2="29.5" y2="38" />
                  <line x1="32" y1="40" x2="34.5" y2="38" />
                  <line x1="24" y1="32" x2="26" y2="29.5" />
                  <line x1="24" y1="32" x2="26" y2="34.5" />
                  <line x1="40" y1="32" x2="38" y2="29.5" />
                  <line x1="40" y1="32" x2="38" y2="34.5" />
                </g>
              </svg>
            </div>
            <h3 style="font-family: 'Playfair Display', serif; font-size: 22px; color: var(--green); margin: 0 0 12px;">Traditional Methods</h3>
            <p style="color: #666; line-height: 1.6; margin: 0;">Wooden cold-pressed technique preserves nutrients and authentic flavor in every drop.</p>
          </div>
          <div style="text-align: center; padding: 24px; border-radius: 16px; transition: all 0.3s ease;" class="benefit-card">
            <div style="width: 64px; height: 64px; margin: 0 auto 16px; background: linear-gradient(135deg, var(--green), var(--green-dark)); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 32px; box-shadow: var(--shadow-md);">âœ“</div>
            <h3 style="font-family: 'Playfair Display', serif; font-size: 22px; color: var(--green); margin: 0 0 12px;">FSSAI Certified</h3>
            <p style="color: #666; line-height: 1.6; margin: 0;">Quality you can trust. Licensed and certified for your peace of mind.</p>
          </div>
          <div style="text-align: center; padding: 24px; border-radius: 16px; transition: all 0.3s ease;" class="benefit-card">
            <div style="width: 64px; height: 64px; margin: 0 auto 16px; background: linear-gradient(135deg, var(--gold), var(--gold-light)); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 32px; box-shadow: var(--shadow-md);">ðŸšš</div>
            <h3 style="font-family: 'Playfair Display', serif; font-size: 22px; color: var(--green); margin: 0 0 12px;">Fresh Delivery</h3>
            <p style="color: #666; line-height: 1.6; margin: 0;">Direct from our mill to your doorstep. Fresh, sealed, and ready to use.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="order">
      <div class="container">
        <h2 class="section-title">Place an Order (No Online Payment)</h2>
        <p class="lead">Submit your details â€” weâ€™ll call you to confirm delivery & payment.</p>
        <form class="card" onsubmit="handleSubmit(event)">
          <div class="form-row" style="display:grid; grid-template-columns: repeat(2, 1fr); gap:20px;">
            <div><label>Full Name<br><input required name="name" type="text" placeholder="Your name" minlength="2" maxlength="50" pattern="[A-Za-z\s]+" title="Please enter a valid name (letters and spaces only)"></label></div>
            <div><label>Phone / WhatsApp<br><input required name="phone" type="tel" placeholder="+91..." pattern="[\+]?[0-9\s\-]{10,15}" title="Please enter a valid phone number (10-15 digits)" maxlength="15"></label></div>
            <div style="grid-column:1/-1"><label>Address<br><input required name="address" type="text" placeholder="Door no, street, area, pincode" minlength="10" maxlength="200" title="Please enter a complete address"></label></div>
            
            <!-- Manual oil selection (shown when cart is empty) -->
            <div id="manualSelection" style="grid-column:1/-1; display:none;">
              <div style="padding:16px; background:#f9f9f9; border-radius:12px; border:2px dashed var(--green);">
                <div id="oilSelectors"></div>
                <button type="button" class="btn" style="margin-top:12px; padding:8px 16px; font-size:14px;" onclick="addManualOil()">+ Add Another Oil</button>
              </div>
            </div>
            
            <div style="grid-column:1/-1"><label>Order Summary<br><textarea id="orderDetails" name="orderDetails" rows="4" placeholder="Your selected items will appear here..." readonly style="background:#f5f5f5; resize:none; overflow:hidden; min-height:80px;"></textarea></label></div>
            <input type="hidden" id="totalAmount" name="totalAmount" value="0">
            <div style="grid-column:1/-1"><label>Additional Notes (optional)<br><textarea name="notes" rows="3" placeholder="Any special delivery instructions..."></textarea></label></div>
          </div>
          <div class="form-buttons" style="display:flex;gap:16px;justify-content:flex-end;margin-top:20px;">
            <button class="btn" type="reset" onclick="clearOrder()">Clear</button>
            <button class="btn fill" type="submit">Submit Order</button>
          </div>
        </form>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <div class="tag">Handcrafted with â¤ï¸ in Namakkal</div>
      <div>Â© 2025 Arumee â€¢ Mani Flour & Oil Mill</div>
      <div class="mini">FSSAI: 22425133000137 â€¢ Phone: 9751425598 / 9443342098</div>
    </div>
  </footer>

  <button id="scrollTop" onclick="window.scrollTo({top:0,behavior:'smooth'})" aria-label="Scroll to top">â†‘</button>
  <a href="https://wa.me/6596395758" id="whatsappBtn" target="_blank" rel="noopener noreferrer" aria-label="Chat on WhatsApp" title="Chat on WhatsApp">
    <img src="arumee_assets/whatsapp_icon.png" alt="WhatsApp" />
  </a>
  <div id="toast" class="toast" role="alert" aria-live="polite"></div>

  <!-- Image Zoom Overlay -->
  <div id="imageZoomOverlay" class="zoom-overlay">
    <div class="zoom-container">
      <button class="zoom-close" onclick="closeImageZoom()">&times;</button>
      <img id="zoomedImage" src="" alt="Zoomed Product Image" />
      <div class="zoom-caption"></div>
    </div>
  </div>

  <!-- Add to Cart Confirmation Modal -->
  <div id="addToCartModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-icon">ðŸ›’</div>
      <h3 class="modal-title">Item Added to Cart</h3>
      <div class="modal-message">
        <p id="addToCartDetails"></p>
      </div>
      <div class="modal-buttons">
        <button class="modal-btn secondary" onclick="continueShoppingFromModal()">Continue Shopping</button>
        <button class="modal-btn primary" onclick="checkoutFromModal()">Proceed to Checkout</button>
      </div>
    </div>
  </div>

  <!-- Custom Modal -->
  <div id="successModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-icon">âœ“</div>
      <h3 class="modal-title">Order Submitted Successfully!</h3>
      <div class="modal-message">
        <p>We will contact you soon to confirm:</p>
        <ul>
          <li>Payment details</li>
          <li>Delivery schedule</li>
        </ul>
        <p style="margin-top: 16px;">Click OK to open WhatsApp and send your order directly to us.</p>
      </div>
      <div class="modal-buttons">
        <button class="modal-btn secondary" onclick="closeModal()">Cancel</button>
        <button class="modal-btn primary" onclick="openWhatsApp()">OK</button>
      </div>
    </div>
  </div>

  <!-- Refresh Warning Modal -->
  <div id="refreshWarningModal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-icon info">â„¹ï¸</div>
      <h3 class="modal-title">Just checking before you refresh</h3>
      <div class="modal-message">
        <p>You have <span id="cartItemCount">0</span> item(s) in your cart.</p>
        <p>Refreshing will clear your current selection and you'll need to add items again.</p>
        <p>Would you like to continue?</p>
      </div>
      <div class="modal-buttons">
        <button class="modal-btn secondary" onclick="cancelRefresh()">Stay Here</button>
        <button class="modal-btn soft-primary" onclick="confirmRefresh()">Refresh Page</button>
      </div>
    </div>
  </div>

  <script>
    // LocalStorage functions for cart persistence
    function saveCartToStorage() {
      localStorage.setItem('arumeeCart', JSON.stringify(orderItems));
    }
    
    function loadCartFromStorage() {
      // Check if this was an intentional refresh
      if (sessionStorage.getItem('intentionalRefresh') === 'true') {
        sessionStorage.removeItem('intentionalRefresh');
        console.log('Intentional refresh detected - not loading cart');
        return;
      }
      
      const savedCart = localStorage.getItem('arumeeCart');
      if (savedCart) {
        try {
          orderItems = JSON.parse(savedCart);
          updateOrderDetails();
        } catch (e) {
          console.log('Could not load cart from storage');
          orderItems = [];
        }
      }
    }
    
    function saveFormDataToStorage() {
      const formData = {
        name: document.querySelector('input[name="name"]')?.value || '',
        phone: document.querySelector('input[name="phone"]')?.value || '',
        address: document.querySelector('input[name="address"]')?.value || ''
      };
      localStorage.setItem('arumeeFormData', JSON.stringify(formData));
    }
    
    function loadFormDataFromStorage() {
      const savedFormData = localStorage.getItem('arumeeFormData');
      if (savedFormData) {
        try {
          const formData = JSON.parse(savedFormData);
          const nameField = document.querySelector('input[name="name"]');
          const phoneField = document.querySelector('input[name="phone"]');
          const addressField = document.querySelector('input[name="address"]');
          
          if (nameField && formData.name) nameField.value = formData.name;
          if (phoneField && formData.phone) phoneField.value = formData.phone;
          if (addressField && formData.address) addressField.value = formData.address;
        } catch (e) {
          console.log('Could not load form data from storage');
        }
      }
    }
    
    let pendingWhatsAppUrl = '';

    function showSuccessModal(whatsappUrl) {
      pendingWhatsAppUrl = whatsappUrl;
      document.getElementById('successModal').classList.add('show');
    }

    function closeModal() {
      document.getElementById('successModal').classList.remove('show');
      pendingWhatsAppUrl = '';
    }

    function openWhatsApp() {
      if (pendingWhatsAppUrl) {
        window.open(pendingWhatsAppUrl, '_blank');
      }
      closeModal();
    }

    // Image Zoom Functions
    function showImageZoom(imageSrc, caption) {
      const overlay = document.getElementById('imageZoomOverlay');
      const zoomedImage = document.getElementById('zoomedImage');
      const zoomCaption = document.querySelector('.zoom-caption');
      
      zoomedImage.src = imageSrc;
      zoomCaption.textContent = caption;
      overlay.classList.add('show');
      
      // Prevent body scroll when zoom is open
      document.body.style.overflow = 'hidden';
    }
    
    function closeImageZoom() {
      const overlay = document.getElementById('imageZoomOverlay');
      overlay.classList.remove('show');
      document.body.style.overflow = '';
    }

    // Refresh Warning Modal Functions
    let pendingRefresh = false;
    
    function showRefreshWarning() {
      document.getElementById('cartItemCount').textContent = orderItems.length;
      document.getElementById('refreshWarningModal').classList.add('show');
    }
    
    function cancelRefresh() {
      document.getElementById('refreshWarningModal').classList.remove('show');
      pendingRefresh = false;
    }
    
    function confirmRefresh() {
      document.getElementById('refreshWarningModal').classList.remove('show');
      pendingRefresh = true;
      // Mark that user intentionally refreshed
      sessionStorage.setItem('intentionalRefresh', 'true');
      // Clear localStorage before refresh
      localStorage.removeItem('arumeeCart');
      localStorage.removeItem('arumeeFormData');
      location.reload();
    }

    // Show order guidance when clicking "Order Without Payment"
    function showOrderGuidance(event) {
      setTimeout(() => {
        showToast('ðŸ‘† Choose your oils and quantities, then scroll down to submit order');
      }, 100);
    }
    
    // Quantity stepper functions
    function increaseQty(id) {
      const input = document.getElementById('qty-' + id);
      const currentVal = parseInt(input.value);
      if (currentVal < parseInt(input.max)) {
        input.value = currentVal + 1;
      }
    }
    function decreaseQty(id) {
      const input = document.getElementById('qty-' + id);
      const currentVal = parseInt(input.value);
      if (currentVal > parseInt(input.min)) {
        input.value = currentVal - 1;
      }
    }
    function validateQty(id) {
      const input = document.getElementById('qty-' + id);
      let val = parseInt(input.value);
      const min = parseInt(input.min);
      const max = parseInt(input.max);
      
      // Remove any non-numeric characters
      if (isNaN(val) || val < min) {
        input.value = min;
      } else if (val > max) {
        input.value = max;
      }
    }

    // Add to order functionality
    let orderItems = [];
    let manualSelectionCounter = 0;
    let isCartOpen = false;
    let preventCartClose = false;

    // Cart Functions
    function toggleCart() {
      const cartDropdown = document.getElementById('cartDropdown');
      const backdrop = document.getElementById('cartBackdrop');
      const cartTab = document.getElementById('cartTab');
      isCartOpen = !isCartOpen;
      
      // Update ARIA attribute
      cartTab.setAttribute('aria-expanded', isCartOpen);
      
      if (isCartOpen) {
        // Ensure element is laid out then animate
        cartDropdown.classList.add('open');
        backdrop.classList.add('visible');
      } else {
        cartDropdown.classList.remove('open');
        backdrop.classList.remove('visible');
      }
    }

    function updateCartDisplay() {
      const cartCount = document.getElementById('cartCount');
      const cartContent = document.getElementById('cartContent');
      const cartFooter = document.getElementById('cartFooter');
      const cartTotal = document.getElementById('cartTotal');
      
      // Update cart count with animation
      const newCount = orderItems.length;
      const oldCount = parseInt(cartCount.textContent);
      
      cartCount.textContent = newCount;
      
      // Trigger bounce animation when count increases
      if (newCount > oldCount) {
        cartCount.style.animation = 'none';
        setTimeout(() => {
          cartCount.style.animation = 'bounce 0.5s ease';
        }, 10);
      }
      
      if (orderItems.length === 0) {
        cartContent.innerHTML = '<p class="empty-cart">Your cart is empty</p>';
        cartFooter.style.display = 'none';
      } else {
        let cartHTML = '';
        let grandTotal = 0;
        
        orderItems.forEach((item, index) => {
          cartHTML += `
            <div class="cart-item">
              <div class="cart-item-info">
                <div class="cart-item-name">${item.productName}</div>
                <div class="cart-item-details">â‚¹${item.price} each</div>
              </div>
              <div class="cart-item-controls">
                <div class="cart-stepper">
                  <button onclick="updateCartItemQty(${index}, -1)">âˆ’</button>
                  <input type="number" value="${item.qty}" min="1" max="10" onchange="setCartItemQty(${index}, this.value)">
                  <button onclick="updateCartItemQty(${index}, 1)">+</button>
                </div>
                <div class="cart-item-price">â‚¹${item.total}</div>
                <button class="cart-delete-btn" onclick="removeCartItem(${index})" title="Remove item">ðŸ—‘ï¸</button>
              </div>
            </div>
          `;
          grandTotal += item.total;
        });
        
        cartContent.innerHTML = cartHTML;
        cartTotal.textContent = `Total: â‚¹${grandTotal}`;
        cartFooter.style.display = 'block';
      }
    }

    function scrollToOrder() {
      toggleCart(); // Close cart
      document.getElementById('order').scrollIntoView({ behavior: 'smooth' });
    }

    // Cart item management functions
    function updateCartItemQty(index, change) {
      if (index >= 0 && index < orderItems.length) {
        const item = orderItems[index];
        const newQty = Math.max(0, Math.min(10, item.qty + change));
        
        // If quantity becomes 0, remove the item
        if (newQty === 0) {
          removeCartItem(index);
          return;
        }
        
        if (newQty !== item.qty) {
          // Prevent cart from closing when updating quantity
          preventCartClose = true;
          setTimeout(() => {
            preventCartClose = false;
          }, 500);
          
          item.qty = newQty;
          item.total = item.price * newQty;
          updateOrderDetails();
          // No toast needed - changes are visible in cart immediately
        }
      }
    }

    function setCartItemQty(index, newQty) {
      const qty = Math.max(1, Math.min(10, parseInt(newQty) || 1));
      
      if (index >= 0 && index < orderItems.length) {
        const item = orderItems[index];
        
        if (item.qty !== qty) {
          // Prevent cart from closing when updating quantity
          preventCartClose = true;
          setTimeout(() => {
            preventCartClose = false;
          }, 500);
        }
        
        item.qty = qty;
        item.total = item.price * qty;
        updateOrderDetails();
        // No toast needed - changes are visible in cart immediately
      }
    }

    function removeCartItem(index) {
      if (index >= 0 && index < orderItems.length) {
        const item = orderItems[index];
        const itemName = item.originalName || item.productName;
        
        // Prevent cart from closing when removing items
        preventCartClose = true;
        setTimeout(() => {
          preventCartClose = false;
        }, 500);
        
        orderItems.splice(index, 1);
        updateOrderDetails();
        toggleManualSelection(); // Show manual selection if cart becomes empty
        showToast(`Removed: ${itemName}`);
      }
    }
    
    const oilOptions = [
      { id: 'coconut-500ml', name: 'Cold-Pressed Coconut Oil (500ml)', price: 225 },
      { id: 'coconut-1L', name: 'Cold-Pressed Coconut Oil (1L)', price: 450 },
      { id: 'coconut-5L', name: 'Cold-Pressed Coconut Oil (5L)', price: 2250 },
      { id: 'groundnut-500ml', name: 'Wooden Cold-Pressed Groundnut Oil (500ml)', price: 275 },
      { id: 'groundnut-1L', name: 'Wooden Cold-Pressed Groundnut Oil (1L)', price: 550 },
      { id: 'groundnut-5L', name: 'Wooden Cold-Pressed Groundnut Oil (5L)', price: 2750 },
      { id: 'gingelly-500ml', name: 'Wooden Cold-Pressed Gingelly Oil (500ml)', price: 275 },
      { id: 'gingelly-1L', name: 'Wooden Cold-Pressed Gingelly Oil (1L)', price: 550 },
      { id: 'gingelly-5L', name: 'Wooden Cold-Pressed Gingelly Oil (5L)', price: 2750 }
    ];
    
    function getCurrentPrice(product) {
      const selectedSizeOption = document.querySelector(`.size-option.active[data-product="${product}"]`);
      return selectedSizeOption ? parseInt(selectedSizeOption.dataset.price) : 225;
    }
    
    function toggleManualSelection() {
      const manualDiv = document.getElementById('manualSelection');
      if (orderItems.length === 0) {
        manualDiv.style.display = 'block';
        if (document.getElementById('oilSelectors').children.length === 0) {
          addManualOil(); // Add first selector
        }
      } else {
        manualDiv.style.display = 'none';
      }
    }
    
    function addManualOil() {
      const selectorsDiv = document.getElementById('oilSelectors');
      
      // Limit to maximum 3 oils (since we only have 3 types)
      if (selectorsDiv.children.length >= 3) {
        showToast('Maximum 3 oils can be selected');
        return;
      }
      
      manualSelectionCounter++;
      const newSelector = document.createElement('div');
      newSelector.id = 'manual-' + manualSelectionCounter;
      newSelector.style.cssText = 'display:grid; grid-template-columns:2fr 1fr auto; gap:10px; margin-bottom:10px; align-items:end;';
      
      newSelector.innerHTML = `
        <div>
          <label style="font-size:13px; font-weight:600; color:var(--green);">Select Oil</label>
          <select class="manual-oil-select" style="width:100%; padding:10px; border:2px solid var(--green); border-radius:8px; font-size:14px;">
            <option value="">Choose an oil...</option>
            ${oilOptions.map(oil => `<option value="${oil.id}" data-price="${oil.price}">${oil.name} - â‚¹${oil.price}</option>`).join('')}
          </select>
        </div>
        <div>
          <label style="font-size:13px; font-weight:600; color:var(--green);">Quantity</label>
          <input type="number" class="manual-qty" min="1" max="10" value="1" style="width:100%; padding:10px; border:2px solid var(--green); border-radius:8px; font-size:14px;" />
        </div>
        <button type="button" onclick="removeManualOil('manual-${manualSelectionCounter}')" style="padding:10px 14px; background:var(--green); color:white; border:none; border-radius:8px; cursor:pointer; font-weight:700;">âœ•</button>
      `;
      
      selectorsDiv.appendChild(newSelector);
      
      // Add change listener to update summary
      newSelector.querySelector('.manual-oil-select').addEventListener('change', updateManualSummary);
      newSelector.querySelector('.manual-qty').addEventListener('input', updateManualSummary);
      
      // Hide "Add Another Oil" button if we've reached 3 oils
      if (selectorsDiv.children.length >= 3) {
        document.querySelector('#manualSelection button[onclick="addManualOil()"]').style.display = 'none';
      }
    }
    
    function removeManualOil(id) {
      const elem = document.getElementById(id);
      if (elem) elem.remove();
      updateManualSummary();
      
      // Show "Add Another Oil" button again if we're below 3 oils
      const selectorsDiv = document.getElementById('oilSelectors');
      if (selectorsDiv.children.length < 3) {
        document.querySelector('#manualSelection button[onclick="addManualOil()"]').style.display = 'inline-block';
      }
    }
    
    function updateManualSummary() {
      const selectors = document.querySelectorAll('#oilSelectors > div');
      let summary = '';
      let total = 0;
      let count = 0;
      
      selectors.forEach((selector, index) => {
        const select = selector.querySelector('.manual-oil-select');
        const qtyInput = selector.querySelector('.manual-qty');
        
        if (select && select.value) {
          const selectedOption = select.options[select.selectedIndex];
          const oilName = selectedOption.text.split(' - ')[0];
          const price = parseInt(selectedOption.dataset.price);
          const qty = parseInt(qtyInput.value) || 1;
          const itemTotal = price * qty;
          
          count++;
          summary += `${count}. ${oilName} = â‚¹${price} Ã— ${qty} = â‚¹${itemTotal}\n`;
          total += itemTotal;
        }
      });
      
      if (summary) {
        summary += `\nTotal Amount: â‚¹${total}\n\n* Delivery charges extra (to be discussed during payment confirmation)`;
      }
      
      const orderDetailsTextarea = document.getElementById('orderDetails');
      const totalAmountField = document.getElementById('totalAmount');
      
      orderDetailsTextarea.value = summary;
      totalAmountField.value = total.toString();
      
      // Auto-expand textarea to fit content
      orderDetailsTextarea.style.height = 'auto';
      orderDetailsTextarea.style.height = Math.max(80, orderDetailsTextarea.scrollHeight) + 'px';
    }
    
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }
    
    function showAddToCartModal(details) {
      document.getElementById('addToCartDetails').textContent = details;
      document.getElementById('addToCartModal').classList.add('show');
    }

    function hideAddToCartModal() {
      document.getElementById('addToCartModal').classList.remove('show');
    }

    function continueShoppingFromModal() {
      hideAddToCartModal();
    }

    function checkoutFromModal() {
      hideAddToCartModal();
      document.getElementById('order').scrollIntoView({ behavior: 'smooth' });
    }

    function addToOrder(id, productName, price) {
      // Get selected size info
      const selectedSizeOption = document.querySelector(`.size-option.active[data-product="${id}"]`);
      const selectedSize = selectedSizeOption ? selectedSizeOption.dataset.size : '500ml';
      const selectedPrice = selectedSizeOption ? parseInt(selectedSizeOption.dataset.price) : price;
      
      const qty = parseInt(document.getElementById('qty-' + id).value);
      const total = selectedPrice * qty;
      
      // Create unique item key with size
      const itemKey = `${id}-${selectedSize}`;
      const fullProductName = `${productName} (${selectedSize})`;
      
      // Check if item already exists, update quantity
      const existingIndex = orderItems.findIndex(item => item.itemKey === itemKey);
      if (existingIndex > -1) {
        orderItems[existingIndex].qty = qty;
        orderItems[existingIndex].total = total;
        const message = `Updated: ${fullProductName} Ã— ${qty} = â‚¹${total}`;
        showAddToCartModal(message);
      } else {
        orderItems.push({ 
          id, 
          itemKey, 
          productName: fullProductName, 
          originalName: productName,
          size: selectedSize,
          price: selectedPrice, 
          qty, 
          total 
        });
        const message = `Added to cart: ${fullProductName} Ã— ${qty} = â‚¹${total}`;
        showAddToCartModal(message);
      }
      
      updateOrderDetails();
      toggleManualSelection(); // Hide manual selection when items added
    }
    
    function updateOrderDetails() {
      const orderDetailsTextarea = document.getElementById('orderDetails');
      const totalAmountField = document.getElementById('totalAmount');
      
      // Update cart display
      updateCartDisplay();
      
      if (orderItems.length === 0) {
        orderDetailsTextarea.value = '';
        orderDetailsTextarea.style.height = '80px';
        totalAmountField.value = '0';
        // Save empty cart to localStorage
        saveCartToStorage();
        return;
      }
      
      let orderText = '';
      let grandTotal = 0;
      
      orderItems.forEach((item, index) => {
        orderText += `${index + 1}. ${item.productName} = â‚¹${item.price} Ã— ${item.qty} = â‚¹${item.total}\n`;
        grandTotal += item.total;
      });
      
      orderText += `\nTotal Amount: â‚¹${grandTotal}\n\n* Delivery charges extra (to be discussed during payment confirmation)`;
      orderDetailsTextarea.value = orderText;
      
      // Set the hidden total amount field
      totalAmountField.value = grandTotal.toString();
      
      // Auto-expand textarea to fit content
      orderDetailsTextarea.style.height = 'auto';
      orderDetailsTextarea.style.height = Math.max(80, orderDetailsTextarea.scrollHeight) + 'px';
      
      // Save cart to localStorage whenever it's updated
      saveCartToStorage();
    }
    
    function clearOrder() {
      orderItems = [];
      updateOrderDetails();
      
      // Reset all quantity inputs to 1
      document.getElementById('qty-coconut').value = 1;
      document.getElementById('qty-groundnut').value = 1;
      document.getElementById('qty-gingelly').value = 1;
      
      // Clear manual selections
      document.getElementById('oilSelectors').innerHTML = '';
      manualSelectionCounter = 0;
      
      // Show manual selection since cart is empty
      toggleManualSelection();
      
      showToast('Order cleared');
    }

    // Form submission
    function handleSubmit(e) {
      e.preventDefault();
      
      // Get form data for validation
      const form = e.target;
      const submitBtn = form.querySelector('button[type="submit"]');
      const name = form.name.value.trim();
      const phone = form.phone.value.trim();
      const address = form.address.value.trim();
      
      // Validate name
      if (!name || name.length < 2) {
        alert('Please enter a valid name (at least 2 characters).');
        form.name.focus();
        return;
      }
      
      if (!/^[A-Za-z\s]+$/.test(name)) {
        alert('Name should contain only letters and spaces.');
        form.name.focus();
        return;
      }
      
      // Validate phone
      if (!phone) {
        alert('Please enter your phone number.');
        form.phone.focus();
        return;
      }
      
      // Remove all non-digits for phone validation
      const phoneDigits = phone.replace(/\D/g, '');
      if (phoneDigits.length < 10 || phoneDigits.length > 15) {
        alert('Please enter a valid phone number (10-15 digits).');
        form.phone.focus();
        return;
      }
      
      // Validate address
      if (!address || address.length < 10) {
        alert('Please enter a complete address (at least 10 characters).');
        form.address.focus();
        return;
      }
      
      // Check if either orderItems has items OR manual selection has data
      const hasCartItems = orderItems.length > 0;
      const manualSelectors = document.querySelectorAll('.manual-oil-select');
      let hasManualSelection = false;
      
      manualSelectors.forEach(select => {
        if (select.value) {
          hasManualSelection = true;
        }
      });
      
      if (!hasCartItems && !hasManualSelection) {
        alert('Please select at least one oil and quantity before placing your order.');
        return;
      }
      
      // If using manual selection, update the order details from manual inputs
      if (!hasCartItems && hasManualSelection) {
        updateManualSummary();
      }
      
      // Show loading state
      submitBtn.classList.add('loading');
      submitBtn.disabled = true;
      
      const GOOGLE_FORM_URL = 'https://docs.google.com/forms/d/e/1FAIpQLSflC-Ev08-1K4ULCfcscEw6WsCDV-tm99cGCAIt_V0-FC7lEg/formResponse';
      
      const formData = new FormData(e.target);
      const googleFormData = new FormData();
      
      // Map form fields to Google Form entry IDs
      googleFormData.append('entry.1725501823', formData.get('name'));        // Full Name
      googleFormData.append('entry.1067964574', formData.get('phone'));       // Phone / WhatsApp
      googleFormData.append('entry.815750809', formData.get('address'));      // Address
      googleFormData.append('entry.1998696792', formData.get('orderDetails')); // Order Details
      googleFormData.append('entry.185274423', formData.get('notes') || 'None'); // Additional Notes
      googleFormData.append('entry.1620525141', formData.get('totalAmount') || '0'); // Total Amount (Replace 123456789 with actual entry ID from your Google Form)
      
      // Submit to Google Form
      fetch(GOOGLE_FORM_URL, {
        method: 'POST',
        body: googleFormData,
        mode: 'no-cors'
      }).then(() => {
        // Remove loading state
        submitBtn.classList.remove('loading');
        submitBtn.disabled = false;
        
        // Success - show confirmation and open WhatsApp
        const name = formData.get('name');
        const phone = formData.get('phone');
        const address = formData.get('address');
        const orderDetails = formData.get('orderDetails');
        const notes = formData.get('notes') || 'None';
        
        // WhatsApp message
        const whatsappNumber = '6596395758'; // Replace with your actual WhatsApp number (include country code, no + or spaces)
        const whatsappMessage = encodeURIComponent(
          `*New Order from ${name}*\n\n` +
          `ðŸ“ž Phone: ${phone}\n` +
          `ðŸ“ Address: ${address}\n\n` +
          `*Order Details:*\n${orderDetails}\n\n` +
          `*Additional Notes:*\n${notes}\n\n` +
          `Please confirm payment and delivery details.`
        );
        
        const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${whatsappMessage}`;
        
        // Show custom modal
        showSuccessModal(whatsappUrl);
        
        // Clear form and scroll to top
        setTimeout(() => {
          e.target.reset();
          clearOrder();
          // Clear saved form data from localStorage
          localStorage.removeItem('arumeeFormData');
          window.scrollTo({top: 0, behavior: 'smooth'});
        }, 1000);
        
      }).catch((error) => {
        // Remove loading state
        submitBtn.classList.remove('loading');
        submitBtn.disabled = false;
        
        // Error - don't clear anything
        console.error('Submission error:', error);
        alert('There was an error submitting your order. Please try again or contact us directly.');
      });
    }
    
    // Scroll to top on page load/refresh - prevent browser scroll restoration
    if ('scrollRestoration' in history) {
      history.scrollRestoration = 'manual';
    }
    window.addEventListener('beforeunload', () => {
      window.scrollTo(0, 0);
    });
    window.addEventListener('load', () => {
      window.scrollTo(0, 0);
    });
    
    // Sticky Navigation
    const stickyNav = document.getElementById('stickyNav');
    const cartTab = document.getElementById('cartTab');
    let lastScroll = 0;
    window.addEventListener('scroll', () => {
      const currentScroll = window.pageYOffset;
      
      // Show sticky nav when scrolled past hero section
      if (currentScroll > 400) {
        stickyNav.classList.add('visible');
        // Move cart down when sticky nav is visible
        if (cartTab) {
          cartTab.style.top = '80px';
        }
      } else {
        stickyNav.classList.remove('visible');
        // Move cart back to original position
        if (cartTab) {
          cartTab.style.top = '20px';
        }
      }
      
      lastScroll = currentScroll;
    });
    
    // Also on DOMContentLoaded for faster trigger
    document.addEventListener('DOMContentLoaded', () => {
      window.scrollTo(0, 0);
      toggleManualSelection(); // Initialize manual selection visibility on page load
      
      // Cart items will be loaded from localStorage
      updateOrderDetails();
      
      // Add form validation listeners
      const nameInput = document.querySelector('input[name="name"]');
      const phoneInput = document.querySelector('input[name="phone"]');
      const addressInput = document.querySelector('input[name="address"]');
      
      // Click outside cart to close
      document.addEventListener('click', function(e) {
        if (preventCartClose) return;
        
        const cartTab = document.getElementById('cartTab');
        const cartDropdown = document.getElementById('cartDropdown');
        
        if (isCartOpen && !cartTab.contains(e.target) && !cartDropdown.contains(e.target)) {
          toggleCart();
        }
      });
      
      // Real-time phone number formatting
      phoneInput.addEventListener('input', function(e) {
        // Allow only numbers, +, spaces, and hyphens
        let value = e.target.value.replace(/[^\d\+\s\-]/g, '');
        e.target.value = value;
      });
      
      // Real-time name validation
      nameInput.addEventListener('input', function(e) {
        // Allow only letters and spaces
        let value = e.target.value.replace(/[^A-Za-z\s]/g, '');
        e.target.value = value;
      });
      
      // Add size option click handlers
      document.querySelectorAll('.size-option').forEach(option => {
        option.addEventListener('click', function() {
          const product = this.dataset.product;
          const size = this.dataset.size;
          const price = this.dataset.price;
          
          // Remove active class from all options for this product
          document.querySelectorAll(`.size-option[data-product="${product}"]`).forEach(opt => {
            opt.classList.remove('active');
          });
          
          // Add active class to clicked option
          this.classList.add('active');
          
          // Update price display
          const priceElement = document.getElementById(`${product}-price`);
          if (priceElement) {
            priceElement.innerHTML = `â‚¹${price} <span>/ ${size}</span>`;
          }
          
          // Update pill display
          const pillElement = document.getElementById(`${product}-pill`);
          if (pillElement) {
            const productType = product.charAt(0).toUpperCase() + product.slice(1);
            pillElement.textContent = `${productType} â€¢ ${size}`;
          }
        });
      });
    });
    
    // Fade in on scroll with improved observer
    const sections = document.querySelectorAll('section');
    const observer = new IntersectionObserver(entries => {
      entries.forEach(e => { 
        if (e.isIntersecting) {
          e.target.classList.add('visible');
          // Optionally stop observing once visible for better performance
          observer.unobserve(e.target);
        }
      });
    }, {threshold: 0.15, rootMargin: '0px 0px -50px 0px'});
    sections.forEach(sec => observer.observe(sec));

    // Scroll-top visibility with throttle
    const topBtn = document.getElementById('scrollTop');
    let scrollTimeout;
    window.addEventListener('scroll', () => {
      if (scrollTimeout) clearTimeout(scrollTimeout);
      
      const shouldShow = window.scrollY > 500;
      if (shouldShow) {
        topBtn.style.display = 'flex';
      } else {
        scrollTimeout = setTimeout(() => {
          topBtn.style.display = 'none';
        }, 200);
      }
    }, { passive: true });
    
    // Load saved data when page loads
    window.addEventListener('load', () => {
      loadCartFromStorage();
      loadFormDataFromStorage();
    });
    
    // Save form data as user types
    document.addEventListener('DOMContentLoaded', () => {
      const formInputs = document.querySelectorAll('input[name="name"], input[name="phone"], input[name="address"]');
      formInputs.forEach(input => {
        input.addEventListener('input', saveFormDataToStorage);
      });
      
      // Helper: detect background color by sampling image corners and remove pixels similar to that color
      // NOTE: This requires the image to be same-origin or served with CORS headers; otherwise canvas will be tainted.
      // Improved background removal: higher default threshold + soft feathering
      // Attempts to remove a uniform background color (estimated from image corners)
      // and applies a gentle alpha ramp to avoid hard halos.
      function removeWhiteBackground(img, threshold = 70, feather = 20) {
        return new Promise((resolve) => {
          try {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = img.naturalWidth || img.width;
            canvas.height = img.naturalHeight || img.height;
            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

            // helper: average color in a small rect
            function avgColor(x, y, w, h) {
              try {
                const d = ctx.getImageData(x, y, w, h).data;
                let r = 0, g = 0, b = 0, n = 0;
                for (let i = 0; i < d.length; i += 4) {
                  r += d[i]; g += d[i + 1]; b += d[i + 2]; n++;
                }
                return { r: Math.round(r / n), g: Math.round(g / n), b: Math.round(b / n) };
              } catch (e) { return null; }
            }

            // Sample small areas in the four corners to estimate background color
            const sample = Math.max(6, Math.floor(Math.min(canvas.width, canvas.height) * 0.03));
            const corners = [];
            corners.push(avgColor(0, 0, sample, sample));
            corners.push(avgColor(canvas.width - sample, 0, sample, sample));
            corners.push(avgColor(0, canvas.height - sample, sample, sample));
            corners.push(avgColor(canvas.width - sample, canvas.height - sample, sample, sample));

            // compute average of non-null corners
            let br = 0, bg = 0, bb = 0, count = 0;
            corners.forEach(c => { if (c) { br += c.r; bg += c.g; bb += c.b; count++; } });
            if (count === 0) { resolve(null); return; }
            const bgColor = { r: Math.round(br / count), g: Math.round(bg / count), b: Math.round(bb / count) };

            try {
              const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
              const data = imageData.data;
              const inner = Math.max(0, threshold);
              const outer = inner + Math.max(0, feather);

              for (let i = 0; i < data.length; i += 4) {
                const r = data[i], g = data[i + 1], b = data[i + 2];
                const dr = r - bgColor.r, dg = g - bgColor.g, db = b - bgColor.b;
                const distSq = dr * dr + dg * dg + db * db;
                const dist = Math.sqrt(distSq);

                if (dist <= inner) {
                  // Fully background â€” make transparent
                  data[i + 3] = 0;
                } else if (dist <= outer) {
                  // In the feather zone â€” set partial alpha to soften edges
                  const t = (dist - inner) / (outer - inner); // 0..1
                  // newAlpha scales from 0 (at inner) to 255 (at outer)
                  const newAlpha = Math.round(255 * t);
                  // Use the smaller of existing alpha and newAlpha to avoid increasing alpha
                  data[i + 3] = Math.min(data[i + 3], newAlpha);
                }
                // else: leave opaque pixels alone
              }

              ctx.putImageData(imageData, 0, 0);

              // Flatten transparency onto a white background so edges look white (no shading)
              try {
                const out = document.createElement('canvas');
                out.width = canvas.width;
                out.height = canvas.height;
                const outCtx = out.getContext('2d');
                // fill white
                outCtx.fillStyle = '#ffffff';
                outCtx.fillRect(0, 0, out.width, out.height);
                // draw processed image on top
                outCtx.drawImage(canvas, 0, 0);
                const newSrc = out.toDataURL();
                console.log('removeWhiteBackground: processed', img.src, 'bgColor=', bgColor, 'threshold=', threshold, 'feather=', feather);
                resolve(newSrc);
              } catch (err2) {
                // if anything goes wrong, fall back to original canvas data
                try { const newSrc = canvas.toDataURL(); resolve(newSrc); } catch (e) { resolve(null); }
              }
            } catch (err) {
              console.warn('Could not process image (CORS?):', err);
              resolve(null);
            }
          } catch (e) {
            console.warn('Background removal failed:', e);
            resolve(null);
          }
        });
      }

      // Add image zoom functionality and attempt background removal for product images
      const productImages = document.querySelectorAll('.pic-wrap img');
      productImages.forEach(img => {
        // Ensure we process after the image has loaded
        function processAndWire() {
          removeWhiteBackground(img).then(newSrc => {
            if (newSrc) {
              img.src = newSrc; // replace with processed image (transparent background)
            }
            // wire zoom behavior
            img.parentElement.addEventListener('click', (e) => {
              e.preventDefault();
              const imageSrc = img.src;
              const caption = img.alt || 'Product Image';
              showImageZoom(imageSrc, caption);
            });
          });
        }

        if (img.complete && img.naturalWidth) {
          processAndWire();
        } else {
          img.addEventListener('load', processAndWire);
        }
      });
      
      // Close zoom overlay when clicking outside image
      document.getElementById('imageZoomOverlay').addEventListener('click', (e) => {
        if (e.target.id === 'imageZoomOverlay') {
          closeImageZoom();
        }
      });
      
      // Close zoom with Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          closeImageZoom();
        }
      });
    });
    
    // Intercept refresh attempts if cart has items
    document.addEventListener('keydown', (e) => {
      // Check for F5 or Ctrl+R (refresh shortcuts)
      if ((e.key === 'F5') || (e.ctrlKey && e.key === 'r') || (e.ctrlKey && e.key === 'R')) {
        if (orderItems.length > 0 && !pendingRefresh) {
          e.preventDefault();
          e.stopPropagation();
          e.stopImmediatePropagation();
          showRefreshWarning();
          return false;
        }
      }
    }, true);
    
    // Handle browser refresh button and other navigation
    window.addEventListener('beforeunload', (e) => {
      console.log('beforeunload triggered, orderItems.length:', orderItems.length, 'pendingRefresh:', pendingRefresh);
      if (orderItems.length > 0 && !pendingRefresh) {
        // Mark that user is leaving/refreshing with items
        sessionStorage.setItem('intentionalRefresh', 'true');
        // Set a custom message (though browsers may override it)
        const message = 'Your cart items will be lost.';
        e.returnValue = message;
        return message;
      }
    });

    /* Carousel active-slide detection: find centered card and toggle class */
    (function setupCarouselActiveSlide() {
      const carousel = document.querySelector('.grid');
      if (!carousel) return;

      const cards = Array.from(carousel.querySelectorAll('.card'));
      if (!cards.length) return;

      // Throttle utility to avoid too many calculations while scrolling
      function throttle(fn, wait) {
        let last = 0;
        let timeout = null;
        return function(...args) {
          const now = Date.now();
          const remaining = wait - (now - last);
          if (remaining <= 0) {
            if (timeout) { clearTimeout(timeout); timeout = null; }
            last = now;
            fn.apply(this, args);
          } else if (!timeout) {
            timeout = setTimeout(() => {
              last = Date.now();
              timeout = null;
              fn.apply(this, args);
            }, remaining);
          }
        };
      }

      function updateActiveSlide() {
        const carouselRect = carousel.getBoundingClientRect();
        const carouselCenter = carouselRect.left + carouselRect.width / 2;

        let closest = null;
        let minDist = Infinity;

        cards.forEach(card => {
          const rect = card.getBoundingClientRect();
          const cardCenter = rect.left + rect.width / 2;
          const dist = Math.abs(carouselCenter - cardCenter);
          if (dist < minDist) {
            minDist = dist;
            closest = card;
          }
        });

        cards.forEach(c => c.classList.toggle('active-slide', c === closest));
      }

      // Run once to initialise
      updateActiveSlide();

      // Listen to scroll and resize events
      const throttled = throttle(updateActiveSlide, 80);
      carousel.addEventListener('scroll', throttled, { passive: true });
      window.addEventListener('resize', throttled);

      // Also update when dynamic content changes (images load)
      cards.forEach(imgCard => {
        const img = imgCard.querySelector('img');
        if (img && !img.complete) img.addEventListener('load', throttled);
      });
    })();
  </script>

<script>
// --- Mobile carousel active-slide centering fix ---
document.addEventListener("DOMContentLoaded", function () {
  const carousel = document.querySelector("#oils .grid");
  if (!carousel) return;

  // Run only on mobile viewports (horizontal scroll)
  if (window.innerWidth <= 768) {
    const cards = Array.from(carousel.querySelectorAll(".card"));
    if (!cards.length) return;

    
    // Robust centering of first card inside a scroll-snap container
    const firstCard = cards[0];
    const prevSnap = carousel.style.scrollSnapType;
    // Temporarily disable snap so we can position precisely
    carousel.style.scrollSnapType = 'none';
    carousel.scrollLeft = 0; // reset
    // Position so first card center aligns to container center
    const centerIt = () => {
      try {
        // Use native snap-aware centering after restoring snap
        carousel.style.scrollSnapType = prevSnap || 'x mandatory';
        // Ensure it's exactly centered in the snap container
        firstCard.scrollIntoView({ behavior: 'auto', inline: 'center', block: 'nearest' });
      } catch(e) {
        // Fallback: math positioning
        const targetLeft = firstCard.offsetLeft - (carousel.clientWidth - firstCard.clientWidth) / 2;
        carousel.scrollLeft = Math.max(0, targetLeft);
      }
      // Make it active immediately
      cards.forEach((c, i) => c.classList.toggle("active-slide", i === 0));
      updateActiveSlide();
    };
    // Wait a tick for layout (images/fonts) then center
    requestAnimationFrame(() => requestAnimationFrame(centerIt));


    function throttle(fn, wait) {
      let ticking = false, lastArgs = null;
      return function (...args) {
        lastArgs = args;
        if (!ticking) {
          ticking = true;
          requestAnimationFrame(() => {
            fn.apply(this, lastArgs);
            ticking = false;
          });
        }
      };
    }

    function updateActiveSlide() {
      const center = carousel.scrollLeft + carousel.clientWidth / 2;
      let bestIdx = 0;
      let bestDist = Infinity;

      cards.forEach((card, idx) => {
        const cardCenter = card.offsetLeft + card.clientWidth / 2;
        const dist = Math.abs(cardCenter - center);
        if (dist < bestDist) { bestDist = dist; bestIdx = idx; }
      });

      cards.forEach((card, idx) => {
        card.classList.toggle("active-slide", idx === bestIdx);
      });
    }

    const throttledUpdate = throttle(updateActiveSlide, 80);
    carousel.addEventListener("scroll", throttledUpdate, { passive: true });
    window.addEventListener("resize", throttledUpdate);
    window.addEventListener("orientationchange", throttledUpdate);
    cards.forEach((c) => {
      const img = c.querySelector("img");
      if (img && !img.complete) img.addEventListener("load", throttledUpdate);
    });

    // Initial activation after layout
    updateActiveSlide();
  }
});
</script>

<script>
// --- Cart animation helpers ---
document.addEventListener('DOMContentLoaded', function(){
  const cartDropdown = document.getElementById('cartDropdown');
  const backdrop = document.getElementById('cartBackdrop');
  // Ensure it's displayed for animation system; opacity/transform handle visibility
  cartDropdown.style.display = 'block';

  // Click outside closes (unless we're in the middle of quantity edits)
  backdrop.addEventListener('click', function(){
    if (preventCartClose) return;
    if (isCartOpen) toggleCart();
  });

  // ESC to close
  document.addEventListener('keydown', function(e){
    if (e.key === 'Escape' && isCartOpen && !preventCartClose) {
      toggleCart();
    }
  });
});
</script>

<script>
// --- Desktop safety: ensure no 'active-slide' class remains on desktop ---
document.addEventListener('DOMContentLoaded', function(){
  function cleanupActiveForDesktop(){
    if (window.innerWidth > 768) {
      document.querySelectorAll('#oils .grid .card.active-slide').forEach(el => el.classList.remove('active-slide'));
    }
  }
  cleanupActiveForDesktop();
  window.addEventListener('resize', cleanupActiveForDesktop);
});
</script>

</body>
</html>
